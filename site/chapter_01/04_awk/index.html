



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.3">
    
    
      
        <title>用 awk 处理 NGS 数据 - My Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.8d40d89b.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#awk-ngs" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="My Docs" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                My Docs
              </span>
              <span class="md-header-nav__topic">
                用 awk 处理 NGS 数据
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    My Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Welcome to MkDocs" class="md-nav__link">
      Welcome to MkDocs
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Chapter 01
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Chapter 01
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../01_basic-cml/" title="基本命令" class="md-nav__link">
      基本命令
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../02_linux-installation/" title="02 linux installation" class="md-nav__link">
      02 linux installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../03_linux-administration/" title="03 linux administration" class="md-nav__link">
      03 linux administration
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        用 awk 处理 NGS 数据
      </label>
    
    <a href="./" title="用 awk 处理 NGS 数据" class="md-nav__link md-nav__link--active">
      用 awk 处理 NGS 数据
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-awk" title="1. 了解 awk 基本用法" class="md-nav__link">
    1. 了解 awk 基本用法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-awk" title="2. awk 基本语法" class="md-nav__link">
    2. awk 基本语法
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-pattern" title="2.1 Pattern" class="md-nav__link">
    2.1 Pattern
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211" title="2.1.1 正则表达式" class="md-nav__link">
    2.1.1 正则表达式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#212" title="2.1.2 语句表达" class="md-nav__link">
    2.1.2 语句表达
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-action" title="2.2 Action" class="md-nav__link">
    2.2 Action
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221-ifelse" title="2.2.1 if...else" class="md-nav__link">
    2.2.1 if...else
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222-while" title="2.2.2 while" class="md-nav__link">
    2.2.2 while
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" title="2.3. 内建变量" class="md-nav__link">
    2.3. 内建变量
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231-awk" title="2.3.1 控制 awk 的变量" class="md-nav__link">
    2.3.1 控制 awk 的变量
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#232" title="2.3.2 传递信息的变量" class="md-nav__link">
    2.3.2 传递信息的变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" title="2.4. 内建函数" class="md-nav__link">
    2.4. 内建函数
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#241" title="2.4.1 数学函数" class="md-nav__link">
    2.4.1 数学函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#242" title="2.4.2 字符串函数" class="md-nav__link">
    2.4.2 字符串函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#243" title="2.4.3 输入输出函数" class="md-nav__link">
    2.4.3 输入输出函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#244" title="2.4.4 时间函数" class="md-nav__link">
    2.4.4 时间函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#245-bit" title="2.4.5 Bit操作函数" class="md-nav__link">
    2.4.5 Bit操作函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#246" title="2.4.6 其他" class="md-nav__link">
    2.4.6 其他
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" title="3. 示例" class="md-nav__link">
    3. 示例
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" title="3.1 对列的操作" class="md-nav__link">
    3.1 对列的操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" title="3.2 对行的操作" class="md-nav__link">
    3.2 对行的操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" title="3.3 格式化输出" class="md-nav__link">
    3.3 格式化输出
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34" title="3.4 合并文件" class="md-nav__link">
    3.4 合并文件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../05_bioawk/" title="05 bioawk" class="md-nav__link">
      05 bioawk
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../06_python/" title="06 python" class="md-nav__link">
      06 python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../07_shell/" title="07 shell" class="md-nav__link">
      07 shell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Chapter 02
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Chapter 02
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_02/01_emboss/" title="01 emboss" class="md-nav__link">
      01 emboss
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_02/02_blast/" title="02 blast" class="md-nav__link">
      02 blast
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_02/08_seqkit/" title="08 seqkit" class="md-nav__link">
      08 seqkit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_02/09_khmer/" title="09 khmer" class="md-nav__link">
      09 khmer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_02/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Chapter 04
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Chapter 04
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_04/03_bacteria-assembly/" title="03 bacteria assembly" class="md-nav__link">
      03 bacteria assembly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_04/04_virus-assembly/" title="04 virus assembly" class="md-nav__link">
      04 virus assembly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_04/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Chapter 05
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Chapter 05
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_05/01_prokka/" title="01 prokka" class="md-nav__link">
      01 prokka
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_05/02_rast/" title="02 rast" class="md-nav__link">
      02 rast
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_05/03_PGAAP/" title="03 PGAAP" class="md-nav__link">
      03 PGAAP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_05/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-awk" title="1. 了解 awk 基本用法" class="md-nav__link">
    1. 了解 awk 基本用法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-awk" title="2. awk 基本语法" class="md-nav__link">
    2. awk 基本语法
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-pattern" title="2.1 Pattern" class="md-nav__link">
    2.1 Pattern
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211" title="2.1.1 正则表达式" class="md-nav__link">
    2.1.1 正则表达式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#212" title="2.1.2 语句表达" class="md-nav__link">
    2.1.2 语句表达
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-action" title="2.2 Action" class="md-nav__link">
    2.2 Action
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221-ifelse" title="2.2.1 if...else" class="md-nav__link">
    2.2.1 if...else
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222-while" title="2.2.2 while" class="md-nav__link">
    2.2.2 while
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" title="2.3. 内建变量" class="md-nav__link">
    2.3. 内建变量
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231-awk" title="2.3.1 控制 awk 的变量" class="md-nav__link">
    2.3.1 控制 awk 的变量
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#232" title="2.3.2 传递信息的变量" class="md-nav__link">
    2.3.2 传递信息的变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" title="2.4. 内建函数" class="md-nav__link">
    2.4. 内建函数
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#241" title="2.4.1 数学函数" class="md-nav__link">
    2.4.1 数学函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#242" title="2.4.2 字符串函数" class="md-nav__link">
    2.4.2 字符串函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#243" title="2.4.3 输入输出函数" class="md-nav__link">
    2.4.3 输入输出函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#244" title="2.4.4 时间函数" class="md-nav__link">
    2.4.4 时间函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#245-bit" title="2.4.5 Bit操作函数" class="md-nav__link">
    2.4.5 Bit操作函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#246" title="2.4.6 其他" class="md-nav__link">
    2.4.6 其他
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" title="3. 示例" class="md-nav__link">
    3. 示例
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" title="3.1 对列的操作" class="md-nav__link">
    3.1 对列的操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" title="3.2 对行的操作" class="md-nav__link">
    3.2 对行的操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" title="3.3 格式化输出" class="md-nav__link">
    3.3 格式化输出
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34" title="3.4 合并文件" class="md-nav__link">
    3.4 合并文件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="awk-ngs">用 awk 处理 NGS 数据</h1>
<p>awk 工具常用来对文件内容按行进行匹配搜索，一旦某一行中的内容与搜索条件匹配，则对该内容做进一步操作。本质上讲，awk 属于数据驱动的程序，因此 awk 程序也非常容易编写与阅读。高通量测序技术带来大量的数据，而生物学分析往往直需要其中特定的部分，这时 awk 就可以大显身手为测序数据的转换与分析提供帮助。我们首先来看一个最简单的 awk 命令程序：</p>
<pre><code class="bash"># 将contigs.fasta文件中序列ID打印到终端
# contigs.fasta内如：
# &gt;seq1
# ATGGGGTCCGATTACCG
# &gt;seq2
# CGGNTTACCGYGACAGT

$ awk '/&gt;/' contigs.fasta

# 屏幕上会输出：
&gt;seq1
&gt;seq2

$ awk '/^ATG/' contigs.fasta内如

#屏幕上会输出：
ATGGGGTCCGATTACCG
</code></pre>

<p>这个命令很简单，就是将 fasta 文件中包含 '&gt;' 字符的行输出，实际上就是将所有的序列头内容输出。作用类似<code>grep "&gt;"</code>。</p>
<p>awk 程序主体主要包括 pattern，action和input file：</p>
<ul>
<li>pattern 表示所要搜索的内容，可以用正则表达式。</li>
<li>{ action } 则表示搜索匹配后要做的操作。</li>
<li>input file：所要搜索的输入内容，比如前面例子的 contigs.fasta</li>
</ul>
<p>awk可以在shell里直接运行：</p>
<pre><code class="bash">$ awk 'pattern { action }' input_file
</code></pre>

<p>也可以写成awk程序来运行。一个 awk 程序往往如下所示：</p>
<pre><code class="awk">#!/usr/bin/awk -f
pattern { action }
</code></pre>

<p>awk 可以不需要输入文件；对于pattern和action来说，2者至少要有一个才能运行。如果没有pattern，则默认匹配任何输入，按行输出并执行action。如果没有action，则匹配pattern并按行输出不做额外操作。</p>
<pre><code class="bash"># 尝试以下语句，在终端打印`hello world`。这里BEGIN是pattern，{ print &quot;hello world&quot; } 是action
$ awk 'BEGIN { print &quot;hello world&quot; }'

# 模拟cat输出终端输入的字符。这里省略了pattern
$ awk '{ print }'
</code></pre>

<p>上面这个例子可以保存成文件（如<code>hello_world</code>）来运行，文件内容如下：</p>
<pre><code class="awk">#!/usr/bin/awk -f
# 注意不同发行版的linux，awk路径有所区别

BEGIN { print &quot;hello world&quot; }
</code></pre>

<p>运行这个程序：</p>
<pre><code class="bash">$ chmod +x hello_world
$ ./hello_world
</code></pre>

<h2 id="1-awk">1. 了解 awk 基本用法</h2>
<pre><code class="bash">$ awk '$1~/gene1/ { print $2 }' input_data
</code></pre>

<p>作用与 cat + grep + sed 类似</p>
<pre><code class="bash">$ cat input_data | grep gene1 | sed {$1}
</code></pre>

<h2 id="2-awk">2. awk 基本语法</h2>
<h3 id="21-pattern">2.1 Pattern</h3>
<h4 id="211">2.1.1 正则表达式</h4>
<p>pattern 可以采用正则表达式来匹配内容。用<code>/ regular expression /</code>来表示。</p>
<p>几个特殊的Patterns：</p>
<ul>
<li>BEGIN:</li>
<li>END:</li>
<li>BEGINFILE:</li>
<li>ENDFILE:</li>
</ul>
<h4 id="212">2.1.2 语句表达</h4>
<pre><code class="bash">$ awk '$1 == &quot;gene&quot; { print $2 }' genes.list
</code></pre>

<h3 id="22-action">2.2 Action</h3>
<h4 id="221-ifelse">2.2.1 if...else</h4>
<pre><code class="bash"># if block
$ awk '{if(condition) print $1}' input

# if else block
$ awk '{if(condition)
&gt;     print $1
&gt; else
&gt;     print $2
&gt; }' input
</code></pre>

<h4 id="222-while">2.2.2 while</h4>
<p>while 控制语句要换行，用4个空格划分控制块。</p>
<pre><code class="bash">$ awk '{ i = 1
&gt;     while (i &lt;= 3) {
&gt;         print $i
&gt;         i++
&gt;     }
&gt; }' input
</code></pre>

<h3 id="23">2.3. 内建变量</h3>
<h4 id="231-awk">2.3.1 控制 awk 的变量</h4>
<ul>
<li>BINMODE #</li>
<li>CONVFMT</li>
<li>FIELDWIDTHS #</li>
<li>FPAT #</li>
<li>FS</li>
<li>IGNORECASE #</li>
<li>LINT #</li>
<li>OFMT</li>
<li>OFS</li>
<li>ORS</li>
<li>PREC #</li>
<li>ROUNDMODE #</li>
<li>RS</li>
<li>SUBSEP</li>
<li>TEXTDOMAIN #</li>
</ul>
<h3 id="232">2.3.2 传递信息的变量</h3>
<ul>
<li>ARGC , ARGV</li>
<li>ARGIND #</li>
<li>ENVIRON</li>
<li>ERRNO #</li>
<li>FILENAME</li>
<li>FNR</li>
<li>NF</li>
<li>FUNCTAB #</li>
<li>NR</li>
<li>PROCINFO #</li>
<li>RLENGTH</li>
<li>RSTART</li>
<li>RT #</li>
<li>SYMTAB #</li>
</ul>
<h3 id="24">2.4. 内建函数</h3>
<h4 id="241">2.4.1 数学函数</h4>
<ul>
<li>atan2(y, x)</li>
<li>cos(x)</li>
<li>exp(x)</li>
<li>int(x)</li>
<li>log(x)</li>
<li>rand()</li>
<li>sin(x)</li>
<li>sqrt(x)</li>
<li>srand([ x ])</li>
</ul>
<h4 id="242">2.4.2 字符串函数</h4>
<ul>
<li>asort(source [ , dest [ , how ] ] ) #</li>
<li>asorti(source [ , dest [ , how ] ] ) #</li>
<li>gensub(regexp, replacement, how [ , target ] ) #</li>
<li>gsub(regexp, replacement [ , target ] )</li>
<li>index(in, find)</li>
<li>length( [ string ] )</li>
<li>match(string, regexp [ , array ] )</li>
<li>patsplit(string, array [ , fieldpat [ , seps ] ] ) #</li>
<li>split(string, array [ , fieldsep [ , seps ] ] )</li>
<li>sprintf(format, expression1, ...)</li>
<li>strtonum(str) #</li>
<li>sub(regexp, replacement [ , target ] )</li>
<li>substr(string, start [ , length ] )</li>
<li>tolower(string)</li>
<li>toupper(string)</li>
</ul>
<h4 id="243">2.4.3 输入输出函数</h4>
<ul>
<li>close(filename [ , how ] )</li>
<li>fflush( [ filename ] )</li>
<li>system(command)</li>
</ul>
<h4 id="244">2.4.4 时间函数</h4>
<ul>
<li>mktime(datespec)</li>
<li>strftime( [ format [ , timestamp [ , utc-flag ] ] ] )</li>
<li>systime()</li>
</ul>
<h4 id="245-bit">2.4.5 Bit操作函数</h4>
<ul>
<li>and(v1, v2 [, ...])</li>
<li>compl(val)</li>
<li>lshift(val, count)</li>
<li>or(v1, v2 [, ...])</li>
<li>rshift(val, count)</li>
<li>xor(v1, v2 [, ...])</li>
</ul>
<h4 id="246">2.4.6 其他</h4>
<ul>
<li>isarray(x)</li>
<li>bindtextdomain(directory [ , domain ] )</li>
<li>dcgettext(string [ , domain [ , category ] ] )</li>
<li>dcngettext(string1, string2, number [ , domain [ , category ] ] )</li>
</ul>
<h2 id="3">3. 示例</h2>
<p>示例部分介绍 awk 在日常中，特别是处理 ngs 数据时的一些例子。</p>
<h3 id="31">3.1 对列的操作</h3>
<p><strong>调整列顺序</strong>：在有GUI的操作系统里，一般采用类似 excel, calc 之类的软件导入数据文件，然后剪切各列调整顺序。如果用 awk 来解决也很方便，你只需要考虑好调整的各列顺序即可，action 里的{ print ...}顺序就是重新调整后的各列顺序：</p>
<pre><code class="bash">$ awk '{ print $3, $5, $7, $2, $1, $4, $6 }' infile.txt &gt; outfile.txt
</code></pre>

<p><strong>插入列</strong>：有时候要插入一列数据，用awk可以很方便的实现：</p>
<pre><code class="bash">$ awk '{ print $1, $2 &quot;gene expression&quot;, $3}' infile.txt &gt; outfile.txt
</code></pre>

<h3 id="32">3.2 对行的操作</h3>
<p><strong>去除重复的行</strong>：有时候数据里含有重复的行，而当你只需要唯一性数据时，就可以用这行程序，只保留具有唯一性的数据行。</p>
<pre><code class="bash">$ awk '!x[$0]++' infile.txt &gt; outfile.txt
</code></pre>

<h3 id="33">3.3 格式化输出</h3>
<pre><code class="bash">$ awk -F&quot;:&quot; 'BEGIN { printf &quot;%-8s %-3s&quot;, &quot;User&quot;, &quot;UID&quot; } \
&gt; NR==1,NR==20 { printf &quot;%-8s %-3d&quot;, $1, $3 }' /etc/passwd
</code></pre>

<h3 id="34">3.4 合并文件</h3>
<pre><code class="bash"># 搜索当前目录下所有包含序列ATCCGGA的fasta文件，并输出文件名和行号以及序列
$ find . -type f -name &quot;*.fasta&quot; -exec awk '/ATCCCGGA/ {print FILENAME, NR, $0}' {} \+
</code></pre>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../03_linux-administration/" title="03 linux administration" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                03 linux administration
              </span>
            </div>
          </a>
        
        
          <a href="../05_bioawk/" title="05 bioawk" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                05 bioawk
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b438e6c5.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>