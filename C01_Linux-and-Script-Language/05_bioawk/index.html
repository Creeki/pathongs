



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="病原微生物高通量测序数据分析手册">
      
      
        <link rel="canonical" href="https://indexofire.github.io/pathongs/C01_Linux-and-Script-Language/05_bioawk/">
      
      
        <meta name="author" content="Mark Renton">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.1">
    
    
      
        <title>05. 测序数据工具 bioawk - Pathogen NGS 数据分析入门</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.3020aac5.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-55420348-3", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#bioawk" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://indexofire.github.io/pathongs" title="Pathogen NGS 数据分析入门" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Pathogen NGS 数据分析入门
            </span>
            <span class="md-header-nav__topic">
              05. 测序数据工具 bioawk
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/indexofire/pathongs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://indexofire.github.io/pathongs" title="Pathogen NGS 数据分析入门" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Pathogen NGS 数据分析入门
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/indexofire/pathongs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="开始之前" class="md-nav__link">
      开始之前
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      第一章 背景知识介绍
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        第一章 背景知识介绍
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../01_basic-cml/" title="01. Linux 基本命令" class="md-nav__link">
      01. Linux 基本命令
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../02_linux-installation/" title="02. Linux 安装实例" class="md-nav__link">
      02. Linux 安装实例
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../03_linux-administration/" title="03. Linux 系统管理" class="md-nav__link">
      03. Linux 系统管理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../04_awk/" title="04. 数据处理常用工具之 awk" class="md-nav__link">
      04. 数据处理常用工具之 awk
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        05. 测序数据工具 bioawk
      </label>
    
    <a href="./" title="05. 测序数据工具 bioawk" class="md-nav__link md-nav__link--active">
      05. 测序数据工具 bioawk
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="内建函数" class="md-nav__link">
    内建函数
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="内建变量" class="md-nav__link">
    内建变量
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1" title="1. 安装" class="md-nav__link">
    1. 安装
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" title="2. 使用示例" class="md-nav__link">
    2. 使用示例
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fastq" title="处理 fastq" class="md-nav__link">
    处理 fastq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bam" title="处理 bam" class="md-nav__link">
    处理 bam
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vcf" title="处理 vcf" class="md-nav__link">
    处理 vcf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bed" title="处理bed" class="md-nav__link">
    处理bed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gff" title="处理gff" class="md-nav__link">
    处理gff
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../06_python/" title="06. Python编程" class="md-nav__link">
      06. Python编程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../07_shell/" title="07. Shell脚本" class="md-nav__link">
      07. Shell脚本
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      第二章 产用工具
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        第二章 产用工具
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C02_Common-Utility/01_emboss/" title="01. EMBOSS 工具集" class="md-nav__link">
      01. EMBOSS 工具集
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C02_Common-Utility/02_blast/" title="02. Blast 与 Blast+" class="md-nav__link">
      02. Blast 与 Blast+
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C02_Common-Utility/08_seqkit/" title="03. 国产序列处理神器 SeqKit" class="md-nav__link">
      03. 国产序列处理神器 SeqKit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C02_Common-Utility/09_kmer/" title="04. K-mer 处理工具" class="md-nav__link">
      04. K-mer 处理工具
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C02_Common-Utility/01_databases/" title="01. 生物公共数据库" class="md-nav__link">
      01. 生物公共数据库
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C02_Common-Utility/02_fileformat.md" title="02. 生物数据文件格式" class="md-nav__link">
      02. 生物数据文件格式
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C02_Common-Utility/03_edirect/" title="03. 玩转 edirect" class="md-nav__link">
      03. 玩转 edirect
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      ‘第三章 各类数据文件格式’
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        ‘第三章 各类数据文件格式’
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C03_File-Format/01_fasta/" title="01. fasta" class="md-nav__link">
      01. fasta
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C03_File-Format/02_embl/" title="02. embl" class="md-nav__link">
      02. embl
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      第四章 基因组组装
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        第四章 基因组组装
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_04/03_bacteria-assembly.md" title="03. 细菌基因组组装" class="md-nav__link">
      03. 细菌基因组组装
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_04/04_virus-assembly.md" title="04. 病毒基因组组装" class="md-nav__link">
      04. 病毒基因组组装
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      第五章 基因组注释
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        第五章 基因组注释
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_05/01_prokka.md" title="01. Prokka 快速注释" class="md-nav__link">
      01. Prokka 快速注释
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_05/02_rast.md" title="02. 在线注释工具 rast" class="md-nav__link">
      02. 在线注释工具 rast
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_05/03_PGAAP.md" title="03. 注释工具 PGAAP" class="md-nav__link">
      03. 注释工具 PGAAP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_05/04_snpEFF.md" title="04. SNP注释工具 snpEFF" class="md-nav__link">
      04. SNP注释工具 snpEFF
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      第六章 Pan和Core基因组分析
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        第六章 Pan和Core基因组分析
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_06/01_pangenome.md" title="01. Pangenome 概述" class="md-nav__link">
      01. Pangenome 概述
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_06/02_get_homologues.md" title="02. Get_Homologues 分析" class="md-nav__link">
      02. Get_Homologues 分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_06/03_BPGA.md" title="03. BPGA 分析" class="md-nav__link">
      03. BPGA 分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_06/04_roary.md" title="04. Roary 分析" class="md-nav__link">
      04. Roary 分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_06/05_panseq.md" title="05. panseq 分析" class="md-nav__link">
      05. panseq 分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_06/06_gubbins.md" title="06. Gubbins 分析" class="md-nav__link">
      06. Gubbins 分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_06/07_orthmcl.md" title="07. OrthMCL 分析" class="md-nav__link">
      07. OrthMCL 分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter_06/08_ITEP.md" title="08. ITEP 分析" class="md-nav__link">
      08. ITEP 分析
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      第八章 基因组可视化工具
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        第八章 基因组可视化工具
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C08_Genome_Visualization/01_igv.md" title="01. igv 查看比对结果" class="md-nav__link">
      01. igv 查看比对结果
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C08_Genome_Visualization/02_BRIG.md" title="02. BRIG 细菌比较基因组分析工具" class="md-nav__link">
      02. BRIG 细菌比较基因组分析工具
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C08_Genome_Visualization/03_circos.md" title="03. circos 工具使用" class="md-nav__link">
      03. circos 工具使用
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      第九章 分析平台
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        第九章 分析平台
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C09_Analysis_Platform/01_docker.md" title="01. 基于 docker 镜像" class="md-nav__link">
      01. 基于 docker 镜像
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C09_Analysis_Platform/02_galaxy.md" title="02. Galaxy 平台" class="md-nav__link">
      02. Galaxy 平台
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C09_Analysis_Platform/03_amazon.md" title="03. Amazon EC2 云平台" class="md-nav__link">
      03. Amazon EC2 云平台
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C09_Analysis_Platform/04_others.md" title="04. 其他平台" class="md-nav__link">
      04. 其他平台
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      第十一章 常见分析工具
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        第十一章 常见分析工具
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C11_Pathogen_NGS_Application/01_srst2.md" title="01. SRST2 短序列比对基因工具" class="md-nav__link">
      01. SRST2 短序列比对基因工具
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C11_Pathogen_NGS_Application/02_mlst.md" title="02. 拼接序列管家基因扫描工具 MLST" class="md-nav__link">
      02. 拼接序列管家基因扫描工具 MLST
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C11_Pathogen_NGS_Application/03_ariba.md" title="03. 拼接序列耐药基因扫描工具 Ariba" class="md-nav__link">
      03. 拼接序列耐药基因扫描工具 Ariba
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C11_Pathogen_NGS_Application/04_csibelia.md" title="04. 细菌共线性分析工具 C-Sibelia" class="md-nav__link">
      04. 细菌共线性分析工具 C-Sibelia
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      第十二章 Shotgun Metagenomics 分析
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        第十二章 Shotgun Metagenomics 分析
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics_Analysis/01_kraken.md" title="01. kraken" class="md-nav__link">
      01. kraken
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics_Analysis/02_centrifuge.md" title="02. centrifuge" class="md-nav__link">
      02. centrifuge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics_Analysis/03_bracken.md" title="03. bracken" class="md-nav__link">
      03. bracken
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics_Analysis/04_sourmash.md" title="04. sourmash" class="md-nav__link">
      04. sourmash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics_Analysis/05_clark.md" title="05. clark" class="md-nav__link">
      05. clark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics_Analysis/06_krona.md" title="06. krona" class="md-nav__link">
      06. krona
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics_Analysis/07_pavian.md" title="07. pavian" class="md-nav__link">
      07. pavian
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      第十三章 单分子测序
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        第十三章 单分子测序
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C13_Single_Molecular_Sequencing/01_nanopore.md" title="01. nanopore" class="md-nav__link">
      01. nanopore
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C13_Single_Molecular_Sequencing/02_pacbio.md" title="02. pacbio" class="md-nav__link">
      02. pacbio
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C13_Single_Molecular_Sequencing/03_canu.md" title="03. canu" class="md-nav__link">
      03. canu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C13_Single_Molecular_Sequencing/04_trimming.md" title="04. trimming" class="md-nav__link">
      04. trimming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C13_Single_Molecular_Sequencing/06_hybrid.md" title="06. hybrid" class="md-nav__link">
      06. hybrid
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      第十四章 进化树构建
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        第十四章 进化树构建
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C14_Phylogeny_Construction/01_msa.md" title="01. 多重序列比对" class="md-nav__link">
      01. 多重序列比对
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-14" type="checkbox" id="nav-14">
    
    <label class="md-nav__link" for="nav-14">
      第十五章 基因组流行病学
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-14">
        第十五章 基因组流行病学
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C15_Pathogen_Geospatial_Analysis/01_cartodb.md" title="01. CartoDB" class="md-nav__link">
      01. CartoDB
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-15" type="checkbox" id="nav-15">
    
    <label class="md-nav__link" for="nav-15">
      第十六章 基因组分析实践
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-15">
        第十六章 基因组分析实践
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C16_Analysis_Examples/01_trace-Pae-from-different-source-by-SNP.md" title="01. 细菌SNP溯源分析一" class="md-nav__link">
      01. 细菌SNP溯源分析一
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C16_Analysis_Examples/02_comparative-analysis-Ban-genomes.md" title="02. 细菌比较基因组学研究" class="md-nav__link">
      02. 细菌比较基因组学研究
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="内建函数" class="md-nav__link">
    内建函数
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="内建变量" class="md-nav__link">
    内建变量
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1" title="1. 安装" class="md-nav__link">
    1. 安装
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" title="2. 使用示例" class="md-nav__link">
    2. 使用示例
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fastq" title="处理 fastq" class="md-nav__link">
    处理 fastq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bam" title="处理 bam" class="md-nav__link">
    处理 bam
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vcf" title="处理 vcf" class="md-nav__link">
    处理 vcf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bed" title="处理bed" class="md-nav__link">
    处理bed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gff" title="处理gff" class="md-nav__link">
    处理gff
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/indexofire/pathongs/edit/master/docs/C01_Linux-and-Script-Language/05_bioawk.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="bioawk">bioawk<a class="headerlink" href="#bioawk" title="Permanent link">&para;</a></h1>
<p><a href="https://github.com/lh3/bioawk">bioawk</a> 是 Heng Li 开发的 awk 扩展工具，增加了对压缩的 BED, GFF, SAM, VCF, FASTA/Q 等文件格式的支持，并内建一些函数，适用于NGS数据的快速输入输出。因为其是 awk 的功能扩展，所以既可以独立以 bioawk 命令，也可以将其 link 到 awk/gawk ，直接代替 awk。</p>
<h3 id="_1">内建函数<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>bioawk 内建了一些 awk 没有的专用于生物序列的函数：</p>
<ul>
<li>gc($seq) 获得序列的GC含量</li>
<li>meanqual($seq) 获得序列的平均Q值</li>
<li>reverse($seq) 将序列5'&lt;-&gt;3'反向</li>
<li>revcomp($seq) 将序列反向互补</li>
<li>qualcount($qual, threshold) 获得大于阈值的序列中碱基数</li>
<li>trimq(qual, begin, end, param) Trims the quality string qual in the Sanger scale using Richard Mott's algorithm (used in Phred). The 0-based beginning and ending positions are written back to beg and end, respectively. The last argument param is the single parameter used in the algorithm, which is optional and defaults 0.05.</li>
<li>and(x, y) bit AND operation (&amp; in C)</li>
<li>or(x, y) bit OR operation (| in C)</li>
<li>xor(x, y) bit XOR operation (^ in C)</li>
</ul>
<h3 id="_2">内建变量<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<ul>
<li>bed: 1:chrom 2:start 3:end 4:name 5:score 6:strand 7:thickstart 8:thickend 9:rgb 10:blockcount 11:blocksizes 12:blockstarts</li>
<li>sam: 1:qname 2:flag 3:rname 4:pos 5:mapq 6:cigar 7:rnext 8:pnext 9:tlen 10:seq 11:qual</li>
<li>vcf: 1:chrom 2:pos 3:id 4:ref 5:alt 6:qual 7:filter 8:info</li>
<li>gff: 1:seqname 2:source 3:feature 4:start 5:end 6:score 7:filter 8:strand 9:group 10:attribute</li>
<li>fastx: 1:name 2:seq 3:qual</li>
</ul>
<h2 id="1">1. 安装<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<p>在 Linux 中安装 bioawk</p>
<div class="codehilite"><pre><span></span><span class="c1"># Ubuntu 中源码编译安装</span>
$ sudo apt-get install bison
$ git clone https://github.com/lh3/bioawk
$ <span class="nb">cd</span> bioawk <span class="o">&amp;&amp;</span> make
$ sudo cp bioawk /usr/local/sbin

<span class="c1"># Archlinux aur 安装包安装</span>
$ git clone https://aur.archlinux.org/bioawk.git
$ <span class="nb">cd</span> bioawk
$ makepkg -si

<span class="c1"># conda 安装</span>
<span class="o">(</span>base<span class="o">)</span>$ conda install bioawk
</pre></div>

<p>查看说明文档</p>
<div class="codehilite"><pre><span></span>$ <span class="nb">cd</span> bioawk
$ man ./awk.1
</pre></div>

<h2 id="2">2. 使用示例<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<p>使用示例部分使用 NCBI SRA 数据库的 illumina 测序数据 SRR1175124 为例</p>
<ul>
<li>fastq: SRR1175124</li>
<li>bed:</li>
<li>vcf:</li>
</ul>
<h3 id="fastq">处理 fastq<a class="headerlink" href="#fastq" title="Permanent link">&para;</a></h3>
<p><strong>计算reads数量</strong></p>
<p>构建测序数据分析的 workflow 时，当 fastq 数据筛选后，如果要查看剩下多少 reads，可以用 bioawk 进行快速统计。</p>
<div class="codehilite"><pre><span></span><span class="c1"># 去除低质量reads后，快速统计fastq里的reads数量</span>
$ bioawk -c fastx <span class="s1">&#39;END { print NR }&#39;</span> SRR1175124_1.fastq.gz
<span class="m">102354</span>
$ <span class="nb">echo</span> <span class="sb">`</span>zcat SRR1175124_1.fastq.gz <span class="p">|</span> wc -l<span class="sb">`</span> / <span class="m">4</span> <span class="p">|</span> bc
<span class="m">102354</span>

<span class="c1"># 统计以GATTAC开头的reads的数量</span>
$ bioawk -c fastx <span class="s1">&#39;$seq ~ /^GATTAC/ {++n} END { print n }&#39;</span> SRR1175124_1.fastq.gz
<span class="c1"># 用 grep 实现</span>
$ zcat SRR1175124_1.fastq.gz <span class="p">|</span> grep <span class="s1">&#39;^GATTAC&#39;</span> <span class="p">|</span> wc -l

<span class="c1"># 查看GC含量大于60%的reads的质量情况</span>
$ bioawk -c fastx <span class="s1">&#39;{if (gc($seq)&gt;0.6) printf &quot;%s\n%s\n\n&quot;, $seq, $qual}&#39;</span> <span class="se">\</span>
&gt; SRR1175124_1.fastq.gz

<span class="c1"># 生成reads的平均Q值</span>
$ bioawk -c fastx <span class="s1">&#39;{print $name, meanqual($seq)}&#39;</span> <span class="se">\</span>
&gt; SRR1175124_1.fastq.gz &gt; meanqual.txt

<span class="c1"># 将前5条reads序列的5&#39;-&gt;3&#39;变为3&#39;-&gt;5&#39;</span>
$ bioawk -c fastx <span class="s1">&#39;{if(NR&lt;6) print reverse($seq)}&#39;</span> SRR1175124_1.fastq.gz

<span class="c1"># 输出前5条reads序列的反义互补序列</span>
$ bioawk -c fastx <span class="s1">&#39;{if(NR&lt;6) print revcomp($seq)}&#39;</span> SRR1175124_1.fastq.gz

<span class="c1"># 输出第100条reads的信息</span>
$ bioawk -c fastx <span class="s1">&#39;NR==100{print &quot;&gt;&quot;$name, gc($seq)}&#39;</span> SRR1175124_1.fastq.gz

<span class="c1"># 统计SRR1175124_1.fastq.gz中reads碱基Q值高于35的个人小于50的reads数</span>
$ bioawk -c fastx <span class="s1">&#39;{if(qualcount($qual, 35)&lt;50) print $name,$seq}&#39;</span> <span class="se">\</span>
&gt; SRR1175124_1.fastq.gz <span class="p">|</span> wc -l

<span class="c1"># 双末端测序的碱基Q值高于35的个数小于50的reads</span>
$ bioawk -c fastx <span class="s1">&#39;{if(qualcount($qual, 35)&lt;50) print $name}&#39;</span> <span class="se">\</span>
&gt; SRR1175124_1.fastq.gz SRR1175124_2.fastq.gz <span class="p">|</span> sort <span class="p">|</span> uniq -c <span class="p">|</span> <span class="se">\</span>
&gt; awk <span class="s1">&#39;$1==2{print}&#39;</span>

<span class="c1"># 输出双末端测序的碱基Q值高于35的个数小于50的reads中以5’-ATG的reads</span>
$ <span class="k">for</span> i in <span class="k">$(</span>bioawk -c fastx <span class="s1">&#39;{if(qualcount($qual, 35)&lt;50) print $name}&#39;</span> <span class="se">\</span>
&gt; SRR1175124_1.fastq.gz  SRR1175124_2.fastq.gz <span class="p">|</span> sort <span class="p">|</span> uniq -c <span class="p">|</span> <span class="se">\</span>
&gt; awk <span class="s1">&#39;$1==2{print $2}&#39;</span><span class="k">)</span><span class="p">;</span> <span class="k">do</span> bioawk -c fastx -v <span class="nv">i</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$i</span><span class="s2">&quot;</span> <span class="se">\</span>
&gt; <span class="s1">&#39;{if($name==i &amp;&amp; $seq ~ /^ATG/) print $name&quot;\n&quot;$seq&quot;\n&quot;$qual&quot;\n&quot;}&#39;</span> <span class="se">\</span>
&gt; SRR1175124_1.fastq.gz SRR1175124_2.fastq.gz<span class="p">;</span> <span class="k">done</span>
</pre></div>

<div class="codehilite"><pre><span></span>$ bioawk -c bed <span class="s1">&#39;{ print $end - $start }&#39;</span> .bed
</pre></div>

<h3 id="bam">处理 bam<a class="headerlink" href="#bam" title="Permanent link">&para;</a></h3>
<h3 id="vcf">处理 vcf<a class="headerlink" href="#vcf" title="Permanent link">&para;</a></h3>
<h3 id="bed">处理bed<a class="headerlink" href="#bed" title="Permanent link">&para;</a></h3>
<h3 id="gff">处理gff<a class="headerlink" href="#gff" title="Permanent link">&para;</a></h3>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../04_awk/" title="04. 数据处理常用工具之 awk" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                04. 数据处理常用工具之 awk
              </span>
            </div>
          </a>
        
        
          <a href="../06_python/" title="06. Python编程" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                06. Python编程
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2018 HZCDC@Lab
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.dc02f8ce.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sequence-diagrams/1.0.6/sequence-diagram-min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script>
      
        <script src="../../assets/js/umlconvert.js"></script>
      
    
  </body>
</html>