


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="病原微生物高通量测序数据分析手册">
      
      
        <link rel="canonical" href="https://pathongs.hzcdclab.org/C01_Linux-and-Script-Language/04_awk/">
      
      
        <meta name="author" content="Mark Renton">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.1, mkdocs-material-5.1.6">
    
    
      
        <title>04. awk 列处理工具 - Pathogen NGS 数据分析入门</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4b9ffd7b.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
        
<link rel="preconnect dns-prefetch" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-55420348-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview")})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#awk-ngs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://pathongs.hzcdclab.org/" title="Pathogen NGS 数据分析入门" class="md-header-nav__button md-logo" aria-label="Pathogen NGS 数据分析入门">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Pathogen NGS 数据分析入门
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              04. awk 列处理工具
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/indexofire/pathongs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://pathongs.hzcdclab.org/" title="Pathogen NGS 数据分析入门" class="md-nav__button md-logo" aria-label="Pathogen NGS 数据分析入门">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Pathogen NGS 数据分析入门
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/indexofire/pathongs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="第零章 开始之前" class="md-nav__link">
      第零章 开始之前
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      第一章 Linux与脚本编程
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第一章 Linux与脚本编程" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第一章 Linux与脚本编程
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../01_linux-installation/" title="01. Linux 安装实例" class="md-nav__link">
      01. Linux 安装实例
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../02_basic-cml/" title="02. Linux 基本命令" class="md-nav__link">
      02. Linux 基本命令
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../03_linux-software/" title="03. Linux 软件管理" class="md-nav__link">
      03. Linux 软件管理
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        04. awk 列处理工具
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="04. awk 列处理工具" class="md-nav__link md-nav__link--active">
      04. awk 列处理工具
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-awk" class="md-nav__link">
    1. awk 命令构成
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-awk" class="md-nav__link">
    2. awk 基本语法
  </a>
  
    <nav class="md-nav" aria-label="2. awk 基本语法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-pattern" class="md-nav__link">
    2.1 Pattern
  </a>
  
    <nav class="md-nav" aria-label="2.1 Pattern">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211" class="md-nav__link">
    2.1.1 正则表达式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#212" class="md-nav__link">
    2.1.2 语句表达
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-action" class="md-nav__link">
    2.2 Action
  </a>
  
    <nav class="md-nav" aria-label="2.2 Action">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221-ifelse" class="md-nav__link">
    2.2.1 if...else
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222-while" class="md-nav__link">
    2.2.2 while
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    2.3. 内建变量
  </a>
  
    <nav class="md-nav" aria-label="2.3. 内建变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231-awk" class="md-nav__link">
    2.3.1 控制 awk 的变量
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#232" class="md-nav__link">
    2.3.2 传递信息的变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    2.4. 内建函数
  </a>
  
    <nav class="md-nav" aria-label="2.4. 内建函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#241" class="md-nav__link">
    2.4.1 数学函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#242" class="md-nav__link">
    2.4.2 字符串函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#243" class="md-nav__link">
    2.4.3 输入输出函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#244" class="md-nav__link">
    2.4.4 时间函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#245-bit" class="md-nav__link">
    2.4.5 Bit操作函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#246" class="md-nav__link">
    2.4.6 其他
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. 示例
  </a>
  
    <nav class="md-nav" aria-label="3. 示例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    3.1 对列的操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    3.2 对行的操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" class="md-nav__link">
    3.3 格式化输出
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34" class="md-nav__link">
    3.4 合并文件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bioawk" class="md-nav__link">
    bioawk
  </a>
  
    <nav class="md-nav" aria-label="bioawk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. 安装
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 使用示例
  </a>
  
    <nav class="md-nav" aria-label="2. 使用示例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fastq" class="md-nav__link">
    处理 fastq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bam" class="md-nav__link">
    处理 bam
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vcf" class="md-nav__link">
    处理 vcf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bed" class="md-nav__link">
    处理 bed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gff" class="md-nav__link">
    处理 gff
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../05_sed/" title="05. sed 行处理工具" class="md-nav__link">
      05. sed 行处理工具
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../06_tools/" title="06. 其他Linux命令行工具" class="md-nav__link">
      06. 其他Linux命令行工具
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../07_shell/" title="07. Shell脚本" class="md-nav__link">
      07. Shell脚本
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../08_perl/" title="08. Perl 编程" class="md-nav__link">
      08. Perl 编程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../09_python/" title="09. Python 编程" class="md-nav__link">
      09. Python 编程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../10_biopython/" title="10. Biopython 编程" class="md-nav__link">
      10. Biopython 编程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../11_r/" title="11. R 编程" class="md-nav__link">
      11. R 编程
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      第二章 常用工具
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第二章 常用工具" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第二章 常用工具
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C02_Common-Utility/01_databases.md" title="01. 基因组公共数据库" class="md-nav__link">
      01. 基因组公共数据库
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C02_Common-Utility/02_blast/" title="02. Blast 比对" class="md-nav__link">
      02. Blast 比对
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C02_Common-Utility/03_edirect/" title="03. Edirect 工具" class="md-nav__link">
      03. Edirect 工具
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C02_Common-Utility/04_emboss/" title="04. EMBOSS 工具集" class="md-nav__link">
      04. EMBOSS 工具集
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C02_Common-Utility/08_seqkit/" title="08. SeqKit 工具" class="md-nav__link">
      08. SeqKit 工具
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C02_Common-Utility/09_kmer/" title="09. Kmer 工具" class="md-nav__link">
      09. Kmer 工具
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      第三章 数据文件格式
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第三章 数据文件格式" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第三章 数据文件格式
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C03_File-Format/01_fasta/" title="01. fasta" class="md-nav__link">
      01. fasta
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C03_File-Format/02_embl/" title="02. embl" class="md-nav__link">
      02. embl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C03_File-Format/03_plain-txt/" title="03. plain text" class="md-nav__link">
      03. plain text
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C03_File-Format/04_gcg/" title="04. gcg" class="md-nav__link">
      04. gcg
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C03_File-Format/05_fastq/" title="05. fastq" class="md-nav__link">
      05. fastq
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C03_File-Format/06_sam-bam/" title="06. sam && bam" class="md-nav__link">
      06. sam && bam
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C03_File-Format/07_bed/" title="07. bed" class="md-nav__link">
      07. bed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C03_File-Format/08_vcf/" title="08. vcf" class="md-nav__link">
      08. vcf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C03_File-Format/09_gff/" title="09. gff" class="md-nav__link">
      09. gff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C03_File-Format/10_cram/" title="10. cram" class="md-nav__link">
      10. cram
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      第四章 基因组组装
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第四章 基因组组装" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第四章 基因组组装
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C04_Pathogen-Genome-Assembly/01_bwa-samtools-pipeline/" title="01. bwa samtools 流程" class="md-nav__link">
      01. bwa samtools 流程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C04_Pathogen-Genome-Assembly/02_gatk/" title="02. GATK 流程" class="md-nav__link">
      02. GATK 流程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C04_Pathogen-Genome-Assembly/03_bacteria-assembly/" title="03. 细菌基因组组装" class="md-nav__link">
      03. 细菌基因组组装
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C04_Pathogen-Genome-Assembly/04_virus-assembly/" title="04. 病毒基因组组装" class="md-nav__link">
      04. 病毒基因组组装
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C04_Pathogen-Genome-Assembly/05_quast/" title="05. Quast 验证" class="md-nav__link">
      05. Quast 验证
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C04_Pathogen-Genome-Assembly/10_snap/" title="10. snap" class="md-nav__link">
      10. snap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C04_Pathogen-Genome-Assembly/11_long-noisy-reads-assembly/" title="11. 长序列比对" class="md-nav__link">
      11. 长序列比对
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C04_Pathogen-Genome-Assembly/12_hybrid-assembly/" title="12. hybrid 组装" class="md-nav__link">
      12. hybrid 组装
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C04_Pathogen-Genome-Assembly/14_bwa-long-sequence-mapping/" title="14. bwa 长序列比对" class="md-nav__link">
      14. bwa 长序列比对
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C04_Pathogen-Genome-Assembly/15_whatshap/" title="15. whatshap" class="md-nav__link">
      15. whatshap
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      第五章 基因组注释
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第五章 基因组注释" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第五章 基因组注释
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C05_Genome-Annotation/01_prokka/" title="01. Prokka 快速注释" class="md-nav__link">
      01. Prokka 快速注释
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C05_Genome-Annotation/02_rast/" title="02. 在线注释工具 rast" class="md-nav__link">
      02. 在线注释工具 rast
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C05_Genome-Annotation/03_pgaap/" title="03. 注释工具 PGAAP" class="md-nav__link">
      03. 注释工具 PGAAP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C05_Genome-Annotation/04_snpeff/" title="04. SNP注释工具 snpEFF" class="md-nav__link">
      04. SNP注释工具 snpEFF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C05_Genome-Annotation/05_cog/" title="05. COG注释" class="md-nav__link">
      05. COG注释
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      第六章 基因组比较
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第六章 基因组比较" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第六章 基因组比较
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C06_Genome-Compare/01_mummer/" title="01. mummer" class="md-nav__link">
      01. mummer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C06_Genome-Compare/02_nucdiff/" title="02. nucdiff" class="md-nav__link">
      02. nucdiff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C06_Genome-Compare/03_mauve/" title="03. mauve" class="md-nav__link">
      03. mauve
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C06_Genome-Compare/04_sibelia/" title="04. sibelia" class="md-nav__link">
      04. sibelia
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C06_Genome-Compare/05_ani/" title="05. ani" class="md-nav__link">
      05. ani
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C06_Genome-Compare/10_bigsi/" title="10. bigsi" class="md-nav__link">
      10. bigsi
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      第七章 泛基因组分析
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第七章 泛基因组分析" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第七章 泛基因组分析
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C07_PanGenome-and-CoreGenome/01_pangenome/" title="01. Pangenome 概述" class="md-nav__link">
      01. Pangenome 概述
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C07_PanGenome-and-CoreGenome/02_get_homologues/" title="02. Get_Homologues 分析" class="md-nav__link">
      02. Get_Homologues 分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C07_PanGenome-and-CoreGenome/03_bpga/" title="03. BPGA 分析" class="md-nav__link">
      03. BPGA 分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C07_PanGenome-and-CoreGenome/04_roary/" title="04. Roary 分析" class="md-nav__link">
      04. Roary 分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C07_PanGenome-and-CoreGenome/05_panseq/" title="05. panseq 分析" class="md-nav__link">
      05. panseq 分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C07_PanGenome-and-CoreGenome/07_orthmcl/" title="07. OrthMCL 分析" class="md-nav__link">
      07. OrthMCL 分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C07_PanGenome-and-CoreGenome/08_itep/" title="08. ITEP 分析" class="md-nav__link">
      08. ITEP 分析
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      第八章 基因组可视化
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第八章 基因组可视化" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第八章 基因组可视化
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C08_Genome-Visualization/01_igv/" title="01. igv 查看比对结果" class="md-nav__link">
      01. igv 查看比对结果
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C08_Genome-Visualization/02_brig/" title="02. BRIG 分析工具" class="md-nav__link">
      02. BRIG 分析工具
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C08_Genome-Visualization/03_circos/" title="03. circos 工具使用" class="md-nav__link">
      03. circos 工具使用
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      第九章 分析平台
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第九章 分析平台" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第九章 分析平台
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C09_Analysis-Platform/01_docker/" title="01. 基于 docker 镜像" class="md-nav__link">
      01. 基于 docker 镜像
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C09_Analysis-Platform/02_galaxy/" title="02. Galaxy 平台" class="md-nav__link">
      02. Galaxy 平台
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C09_Analysis-Platform/03_amazon/" title="03. Amazon EC2 云平台" class="md-nav__link">
      03. Amazon EC2 云平台
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C09_Analysis-Platform/04_others/" title="04. 其他平台" class="md-nav__link">
      04. 其他平台
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      第十章 重组与种群分析
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第十章 重组与种群分析" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第十章 重组与种群分析
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C10_Recombination-and-Population-Structure/01_virus-recombination/" title="01. 病毒重组" class="md-nav__link">
      01. 病毒重组
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C10_Recombination-and-Population-Structure/02_gubbins/" title="02. Gubbins 分析" class="md-nav__link">
      02. Gubbins 分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C10_Recombination-and-Population-Structure/03_baps/" title="03. BAPS" class="md-nav__link">
      03. BAPS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      第十一章 扫描工具
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第十一章 扫描工具" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第十一章 扫描工具
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C11_Insilico-Genome-Application/01_srst2/" title="01. SRST2 短序列扫描工具" class="md-nav__link">
      01. SRST2 短序列扫描工具
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C11_Insilico-Genome-Application/02_mlst/" title="02. MLST 扫描工具" class="md-nav__link">
      02. MLST 扫描工具
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C11_Insilico-Genome-Application/03_ariba/" title="03. Ariba 耐药基因" class="md-nav__link">
      03. Ariba 耐药基因
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C11_Insilico-Genome-Application/04_abricate/" title="04. Abricate 多功能扫描工具" class="md-nav__link">
      04. Abricate 多功能扫描工具
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      第十二章 宏基因组分析
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第十二章 宏基因组分析" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第十二章 宏基因组分析
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics-Analysis/01_kraken/" title="01. kraken" class="md-nav__link">
      01. kraken
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics-Analysis/02_centrifuge/" title="02. centrifuge" class="md-nav__link">
      02. centrifuge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics-Analysis/03_bracken/" title="03. bracken" class="md-nav__link">
      03. bracken
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics-Analysis/04_sourmash/" title="04. sourmash" class="md-nav__link">
      04. sourmash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics-Analysis/05_clark/" title="05. clark" class="md-nav__link">
      05. clark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics-Analysis/06_krona/" title="06. krona" class="md-nav__link">
      06. krona
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics-Analysis/07_pavian/" title="07. pavian" class="md-nav__link">
      07. pavian
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics-Analysis/08_supri/" title="08. supri" class="md-nav__link">
      08. supri
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics-Analysis/09_shotgun/" title="‘09. shotgun 分析’" class="md-nav__link">
      ‘09. shotgun 分析’
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics-Analysis/10_16s/" title="10. 16S 种群分析" class="md-nav__link">
      10. 16S 种群分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics-Analysis/11_kmerfinder/" title="11. KmerFinder" class="md-nav__link">
      11. KmerFinder
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C12_Metagenomics-Analysis/12_meta-beetl/" title="12. Meta-BEETL" class="md-nav__link">
      12. Meta-BEETL
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-14" type="checkbox" id="nav-14">
    
    <label class="md-nav__link" for="nav-14">
      第十三章 单分子测序
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第十三章 单分子测序" data-md-level="1">
      <label class="md-nav__title" for="nav-14">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第十三章 单分子测序
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C13_Single-Molecular-Sequencing/01_nanopore/" title="01. nanopore" class="md-nav__link">
      01. nanopore
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C13_Single-Molecular-Sequencing/02_pacbio/" title="02. pacbio" class="md-nav__link">
      02. pacbio
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C13_Single-Molecular-Sequencing/03_canu/" title="03. canu" class="md-nav__link">
      03. canu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C13_Single-Molecular-Sequencing/04_seqs-polish/" title="04. trimming" class="md-nav__link">
      04. trimming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C13_Single-Molecular-Sequencing/06_hybrid-assembling/" title="06. hybrid" class="md-nav__link">
      06. hybrid
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-15" type="checkbox" id="nav-15">
    
    <label class="md-nav__link" for="nav-15">
      第十四章 多重序列比对
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第十四章 多重序列比对" data-md-level="1">
      <label class="md-nav__title" for="nav-15">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第十四章 多重序列比对
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C14_Multiple-Sequence-Alignment/01_msa/" title="01. 多重序列比对" class="md-nav__link">
      01. 多重序列比对
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C14_Phylogeny-Analysis/02_raxml.md" title="02. RAxML" class="md-nav__link">
      02. RAxML
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-16" type="checkbox" id="nav-16">
    
    <label class="md-nav__link" for="nav-16">
      第十五章 进化树构建分析
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第十五章 进化树构建分析" data-md-level="1">
      <label class="md-nav__title" for="nav-16">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第十五章 进化树构建分析
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C15_Phylogeny-Analysis/00_all-about-phylogeny/" title="00. 构建进化书" class="md-nav__link">
      00. 构建进化书
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C15_Phylogeny-Analysis/01_figtree/" title="01. figtree" class="md-nav__link">
      01. figtree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C15_Phylogeny-Analysis/02_ggtree/" title="02. ggtree" class="md-nav__link">
      02. ggtree
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-17" type="checkbox" id="nav-17">
    
    <label class="md-nav__link" for="nav-17">
      第十六章 综合分析平台
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第十六章 综合分析平台" data-md-level="1">
      <label class="md-nav__title" for="nav-17">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第十六章 综合分析平台
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C16_Standalone-Platform/01_anvio/" title="01. anvio" class="md-nav__link">
      01. anvio
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C16_Standalone-Platform/02_galaxy/" title="02. galaxy" class="md-nav__link">
      02. galaxy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-18" type="checkbox" id="nav-18">
    
    <label class="md-nav__link" for="nav-18">
      第十七章 地理流行病学分析
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第十七章 地理流行病学分析" data-md-level="1">
      <label class="md-nav__title" for="nav-18">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第十七章 地理流行病学分析
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C17_Pathogen-Geospatial-Analysis/04_cartodb/" title="04. CartoDB" class="md-nav__link">
      04. CartoDB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C17_Pathogen-Geospatial-Analysis/05_leaflet/" title="05. leaflet" class="md-nav__link">
      05. leaflet
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-19" type="checkbox" id="nav-19">
    
    <label class="md-nav__link" for="nav-19">
      第十八章 基因组分析实践
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第十八章 基因组分析实践" data-md-level="1">
      <label class="md-nav__title" for="nav-19">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第十八章 基因组分析实践
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C18_Analysis-Examples/01_trace-Pae-from-different-source-by-SNP/" title="01. 细菌SNP溯源分析一" class="md-nav__link">
      01. 细菌SNP溯源分析一
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C18_Analysis-Examples/02_comparative-analysis-Ban-genomes/" title="02. 细菌比较基因组学研究" class="md-nav__link">
      02. 细菌比较基因组学研究
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-20" type="checkbox" id="nav-20">
    
    <label class="md-nav__link" for="nav-20">
      第十九章 创建工具流
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第十九章 创建工具流" data-md-level="1">
      <label class="md-nav__title" for="nav-20">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第十九章 创建工具流
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C19_Pipelines-and-Workflows/05_workflow-software/" title="05. workflow工具软件" class="md-nav__link">
      05. workflow工具软件
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-21" type="checkbox" id="nav-21">
    
    <label class="md-nav__link" for="nav-21">
      第二十章 其他
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="第二十章 其他" data-md-level="1">
      <label class="md-nav__title" for="nav-21">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        第二十章 其他
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C20_Others/02_gi-to-accession/" title="02. GI转Accession" class="md-nav__link">
      02. GI转Accession
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../C20_Others/05_covid19-pathogen/" title="05. Covid-19基因组测序" class="md-nav__link">
      05. Covid-19基因组测序
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-awk" class="md-nav__link">
    1. awk 命令构成
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-awk" class="md-nav__link">
    2. awk 基本语法
  </a>
  
    <nav class="md-nav" aria-label="2. awk 基本语法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-pattern" class="md-nav__link">
    2.1 Pattern
  </a>
  
    <nav class="md-nav" aria-label="2.1 Pattern">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211" class="md-nav__link">
    2.1.1 正则表达式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#212" class="md-nav__link">
    2.1.2 语句表达
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-action" class="md-nav__link">
    2.2 Action
  </a>
  
    <nav class="md-nav" aria-label="2.2 Action">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221-ifelse" class="md-nav__link">
    2.2.1 if...else
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222-while" class="md-nav__link">
    2.2.2 while
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    2.3. 内建变量
  </a>
  
    <nav class="md-nav" aria-label="2.3. 内建变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231-awk" class="md-nav__link">
    2.3.1 控制 awk 的变量
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#232" class="md-nav__link">
    2.3.2 传递信息的变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    2.4. 内建函数
  </a>
  
    <nav class="md-nav" aria-label="2.4. 内建函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#241" class="md-nav__link">
    2.4.1 数学函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#242" class="md-nav__link">
    2.4.2 字符串函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#243" class="md-nav__link">
    2.4.3 输入输出函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#244" class="md-nav__link">
    2.4.4 时间函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#245-bit" class="md-nav__link">
    2.4.5 Bit操作函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#246" class="md-nav__link">
    2.4.6 其他
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. 示例
  </a>
  
    <nav class="md-nav" aria-label="3. 示例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    3.1 对列的操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    3.2 对行的操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" class="md-nav__link">
    3.3 格式化输出
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34" class="md-nav__link">
    3.4 合并文件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bioawk" class="md-nav__link">
    bioawk
  </a>
  
    <nav class="md-nav" aria-label="bioawk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. 安装
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 使用示例
  </a>
  
    <nav class="md-nav" aria-label="2. 使用示例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fastq" class="md-nav__link">
    处理 fastq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bam" class="md-nav__link">
    处理 bam
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vcf" class="md-nav__link">
    处理 vcf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bed" class="md-nav__link">
    处理 bed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gff" class="md-nav__link">
    处理 gff
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/indexofire/pathongs/edit/master/docs/C01_Linux-and-Script-Language/04_awk.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="awk-ngs">用 awk 处理 NGS 数据<a class="headerlink" href="#awk-ngs" title="Permanent link">&para;</a></h1>
<hr />
<p><img alt="awk" src="https://pbs.twimg.com/media/DeLcVfSWAAAw6OZ.jpg" /></p>
<div class="admonition abstract">
<p class="admonition-title">内容简介</p>
<p>awk 工具常用来对文件内容按行进行匹配搜索，一旦某一行中的内容与搜索条件匹配，则对该内容做进一步操作。本质上讲，awk 属于数据驱动的程序，因此 awk 程序也非常容易编写与阅读。高通量测序技术带来大量的数据，而生物学分析往往直需要其中特定的部分，这时 awk 就可以大显身手为测序数据的转换与分析提供帮助。</p>
</div>
<p><strong>我们首先来看一个最简单的 awk 命令程序：</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># 将contigs.fasta文件中序列ID打印到终端</span>
$ cat contigs.fasta
&gt;seq1
ATGGGGTCCGATTACCG
&gt;seq2
CGGNTTACCGYGACAGT

<span class="c1"># 提取序列名称</span>
$ awk <span class="s1">&#39;/&gt;/&#39;</span> contigs.fasta
&gt;seq1
&gt;seq2

<span class="c1"># 提取ATG开始的序列</span>
$ awk <span class="s1">&#39;/^ATG/&#39;</span> contigs.fasta
ATGGGGTCCGATTACCG

<span class="c1"># 当第一列包含gene1字符时，打印第二列信息</span>
$ awk <span class="s1">&#39;$1 ~/gene1/ {print $2}&#39;</span> input_data
<span class="c1"># 用 grep 和 sed 实现类似效果</span>
$ cat input_data <span class="p">|</span> grep gene1 <span class="p">|</span> sed <span class="o">{</span><span class="nv">$1</span><span class="o">}</span>
</code></pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>awk也是一行行输出，用模式匹配时，与 grep 类似。使用这个命令很简单，就是将 fasta 文件中包含 '&gt;' 字符的行输出，实际上就是将所有的序列头内容输出。作用类似<code>grep "&gt;"</code>。</p>
</div>
<h2 id="1-awk">1. awk 命令构成<a class="headerlink" href="#1-awk" title="Permanent link">&para;</a></h2>
<p>awk 程序主体主要包括 pattern，action和input file：</p>
<ul>
<li>pattern 表示所要搜索的内容，可以用正则表达式。</li>
<li>{ action } 则表示搜索匹配后要做的操作。</li>
<li>input file：所要搜索的输入内容，比如前面例子的 contigs.fasta</li>
</ul>
<div class="admonition info">
<p class="admonition-title">知识点</p>
<p>awk可以在shell里直接运行：</p>
<div class="highlight"><pre><span></span><code>$ awk <span class="s1">&#39;pattern { action }&#39;</span> input_file
</code></pre></div>

<p>也可以写成awk程序来运行。一个 awk 程序往往如下所示：</p>
<div class="highlight"><pre><span></span><code><span class="c1">#!/usr/bin/awk -f</span>
<span class="nx">pattern</span> <span class="p">{</span> <span class="nx">action</span> <span class="p">}</span>
</code></pre></div>

</div>
<p>awk 可以不需要输入文件；对于pattern和action来说，2者至少要有一个才能运行。如果没有pattern，则默认匹配任何输入，按行输出并执行action。如果没有action，则匹配pattern并按行输出不做额外操作。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 尝试以下语句，在终端打印`hello world`。这里BEGIN是pattern，{ print &quot;hello world&quot; } 是action</span>
$ awk <span class="s1">&#39;BEGIN { print &quot;hello world&quot; }&#39;</span>

<span class="c1"># 模拟cat输出终端输入的字符。这里省略了pattern</span>
$ awk <span class="s1">&#39;{ print }&#39;</span>
</code></pre></div>

<p>上面这个例子可以保存成文件（如<code>hello_world</code>）来运行，文件内容如下：</p>
<div class="highlight"><pre><span></span><code><span class="c1">#!/usr/bin/awk -f</span>
<span class="c1"># 注意不同发行版的linux，awk路径有所区别</span>

<span class="nb">BEGIN</span> <span class="p">{</span> <span class="kr">print</span> <span class="s2">&quot;hello world&quot;</span> <span class="p">}</span>
</code></pre></div>

<p>运行这个程序：</p>
<div class="highlight"><pre><span></span><code>$ chmod +x hello_world
$ ./hello_world
</code></pre></div>

<h2 id="2-awk">2. awk 基本语法<a class="headerlink" href="#2-awk" title="Permanent link">&para;</a></h2>
<h3 id="21-pattern">2.1 Pattern<a class="headerlink" href="#21-pattern" title="Permanent link">&para;</a></h3>
<h4 id="211">2.1.1 正则表达式<a class="headerlink" href="#211" title="Permanent link">&para;</a></h4>
<p>pattern 可以采用正则表达式来匹配内容。用<code>/ regular expression /</code>来表示。</p>
<p>几个特殊的Patterns：</p>
<ul>
<li>BEGIN:</li>
<li>END:</li>
<li>BEGINFILE:</li>
<li>ENDFILE:</li>
</ul>
<h4 id="212">2.1.2 语句表达<a class="headerlink" href="#212" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>$ awk <span class="s1">&#39;$1 == &quot;gene&quot; { print $2 }&#39;</span> genes.list
</code></pre></div>

<h3 id="22-action">2.2 Action<a class="headerlink" href="#22-action" title="Permanent link">&para;</a></h3>
<h4 id="221-ifelse">2.2.1 if...else<a class="headerlink" href="#221-ifelse" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># if block</span>
$ awk <span class="s1">&#39;{if(condition) print $1}&#39;</span> input

<span class="c1"># if else block</span>
$ awk <span class="s1">&#39;{if(condition)</span>
<span class="s1">&gt;     print $1</span>
<span class="s1">&gt; else</span>
<span class="s1">&gt;     print $2</span>
<span class="s1">&gt; }&#39;</span> input
</code></pre></div>

<h4 id="222-while">2.2.2 while<a class="headerlink" href="#222-while" title="Permanent link">&para;</a></h4>
<p>while 控制语句要换行，用4个空格划分控制块。</p>
<div class="highlight"><pre><span></span><code>$ awk <span class="s1">&#39;{ i = 1</span>
<span class="s1">&gt;     while (i &lt;= 3) {</span>
<span class="s1">&gt;         print $i</span>
<span class="s1">&gt;         i++</span>
<span class="s1">&gt;     }</span>
<span class="s1">&gt; }&#39;</span> input
</code></pre></div>

<h3 id="23">2.3. 内建变量<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<h4 id="231-awk">2.3.1 控制 awk 的变量<a class="headerlink" href="#231-awk" title="Permanent link">&para;</a></h4>
<ul>
<li>BINMODE #</li>
<li>CONVFMT</li>
<li>FIELDWIDTHS #</li>
<li>FPAT #</li>
<li>FS</li>
<li>IGNORECASE #</li>
<li>LINT #</li>
<li>OFMT</li>
<li>OFS</li>
<li>ORS</li>
<li>PREC #</li>
<li>ROUNDMODE #</li>
<li>RS</li>
<li>SUBSEP</li>
<li>TEXTDOMAIN #</li>
</ul>
<h3 id="232">2.3.2 传递信息的变量<a class="headerlink" href="#232" title="Permanent link">&para;</a></h3>
<ul>
<li>ARGC , ARGV</li>
<li>ARGIND #</li>
<li>ENVIRON</li>
<li>ERRNO #</li>
<li>FILENAME</li>
<li>FNR</li>
<li>NF</li>
<li>FUNCTAB #</li>
<li>NR</li>
<li>PROCINFO #</li>
<li>RLENGTH</li>
<li>RSTART</li>
<li>RT #</li>
<li>SYMTAB #</li>
</ul>
<h3 id="24">2.4. 内建函数<a class="headerlink" href="#24" title="Permanent link">&para;</a></h3>
<h4 id="241">2.4.1 数学函数<a class="headerlink" href="#241" title="Permanent link">&para;</a></h4>
<ul>
<li>atan2(y, x)</li>
<li>cos(x)</li>
<li>exp(x)</li>
<li>int(x)</li>
<li>log(x)</li>
<li>rand()</li>
<li>sin(x)</li>
<li>sqrt(x)</li>
<li>srand([ x ])</li>
</ul>
<h4 id="242">2.4.2 字符串函数<a class="headerlink" href="#242" title="Permanent link">&para;</a></h4>
<ul>
<li>asort(source [ , dest [ , how ] ] ) #</li>
<li>asorti(source [ , dest [ , how ] ] ) #</li>
<li>gensub(regexp, replacement, how [ , target ] ) #</li>
<li>gsub(regexp, replacement [ , target ] )</li>
<li>index(in, find)</li>
<li>length( [ string ] )</li>
<li>match(string, regexp [ , array ] )</li>
<li>patsplit(string, array [ , fieldpat [ , seps ] ] ) #</li>
<li>split(string, array [ , fieldsep [ , seps ] ] )</li>
<li>sprintf(format, expression1, ...)</li>
<li>strtonum(str) #</li>
<li>sub(regexp, replacement [ , target ] )</li>
<li>substr(string, start [ , length ] )</li>
<li>tolower(string)</li>
<li>toupper(string)</li>
</ul>
<h4 id="243">2.4.3 输入输出函数<a class="headerlink" href="#243" title="Permanent link">&para;</a></h4>
<ul>
<li>close(filename [ , how ] )</li>
<li>fflush( [ filename ] )</li>
<li>system(command)</li>
</ul>
<h4 id="244">2.4.4 时间函数<a class="headerlink" href="#244" title="Permanent link">&para;</a></h4>
<ul>
<li>mktime(datespec)</li>
<li>strftime( [ format [ , timestamp [ , utc-flag ] ] ] )</li>
<li>systime()</li>
</ul>
<h4 id="245-bit">2.4.5 Bit操作函数<a class="headerlink" href="#245-bit" title="Permanent link">&para;</a></h4>
<ul>
<li>and(v1, v2 [, ...])</li>
<li>compl(val)</li>
<li>lshift(val, count)</li>
<li>or(v1, v2 [, ...])</li>
<li>rshift(val, count)</li>
<li>xor(v1, v2 [, ...])</li>
</ul>
<h4 id="246">2.4.6 其他<a class="headerlink" href="#246" title="Permanent link">&para;</a></h4>
<ul>
<li>isarray(x)</li>
<li>bindtextdomain(directory [ , domain ] )</li>
<li>dcgettext(string [ , domain [ , category ] ] )</li>
<li>dcngettext(string1, string2, number [ , domain [ , category ] ] )</li>
</ul>
<h2 id="3">3. 示例<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<p>示例部分介绍 awk 在日常中，特别是处理 ngs 数据时的一些例子。</p>
<h3 id="31">3.1 对列的操作<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<p><strong>调整列顺序</strong>：在有GUI的操作系统里，一般采用类似 excel, calc 之类的软件导入数据文件，然后剪切各列调整顺序。如果用 awk 来解决也很方便，你只需要考虑好调整的各列顺序即可，action 里的{ print ...}顺序就是重新调整后的各列顺序：</p>
<p><div class="highlight"><pre><span></span><code>$ awk <span class="s1">&#39;{ print $3, $5, $7, $2, $1, $4, $6 }&#39;</span> infile.txt &gt; outfile.txt
</code></pre></div>
<strong>插入列</strong>：有时候要插入一列数据，用awk可以很方便的实现：</p>
<div class="highlight"><pre><span></span><code>$ awk <span class="s1">&#39;{ print $1, $2 &quot;gene expression&quot;, $3}&#39;</span> infile.txt &gt; outfile.txt
</code></pre></div>

<h3 id="32">3.2 对行的操作<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 有时候数据里含有重复的行，而当你只需要唯一性数据时，就可以用这行程序，只保留具有唯一性的数据行。</span>
$ awk <span class="s1">&#39;!x[$0]++&#39;</span> infile.txt &gt; outfile.txt

<span class="c1"># 不显示重复的行</span>
$ awk <span class="s1">&#39;_[$0]++&#39;</span> infile.txt
<span class="c1"># 当字段1重复时，打印整行</span>
$ awk <span class="s1">&#39;_[$0]++{print $2}&#39;</span> infile.txt
</code></pre></div>

<h3 id="33">3.3 格式化输出<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>$ awk -F<span class="s2">&quot;:&quot;</span> <span class="s1">&#39;BEGIN { printf &quot;%-8s %-3s&quot;, &quot;User&quot;, &quot;UID&quot; } \</span>
<span class="s1">&gt; NR==1,NR==20 { printf &quot;%-8s %-3d&quot;, $1, $3 }&#39;</span> /etc/passwd
</code></pre></div>

<h3 id="34">3.4 合并文件<a class="headerlink" href="#34" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 搜索当前目录下所有包含序列ATCCGGA的fasta文件，并输出文件名和行号以及序列</span>
$ find . -type f -name <span class="s2">&quot;*.fasta&quot;</span> -exec awk <span class="s1">&#39;/ATCCCGGA/ {print FILENAME, NR, $0}&#39;</span> <span class="o">{}</span> <span class="se">\+</span>
</code></pre></div>

<hr />
<h2 id="bioawk">bioawk<a class="headerlink" href="#bioawk" title="Permanent link">&para;</a></h2>
<p><a href="https://github.com/lh3/bioawk">bioawk</a> 是 Heng Li 开发的 awk 扩展工具，增加了对压缩的 BED, GFF, SAM, VCF, FASTA/Q 等文件格式的支持，并内建一些函数，适用于NGS数据的快速输入输出。因为其是 awk 的功能扩展，所以既可以独立以 bioawk 命令，也可以将其 link 到 awk/gawk ，直接代替 awk。</p>
<p><strong>内建函数</strong></p>
<p>bioawk 内建了一些 awk 没有的专用于生物序列的函数：</p>
<ul>
<li>gc($seq) 获得序列的GC含量</li>
<li>meanqual($seq) 获得序列的平均Q值</li>
<li>reverse($seq) 将序列5'&lt;-&gt;3'反向</li>
<li>revcomp($seq) 将序列反向互补</li>
<li>qualcount($qual, threshold) 获得大于阈值的序列中碱基数</li>
<li>trimq(qual, begin, end, param) Trims the quality string qual in the Sanger scale using Richard Mott's algorithm (used in Phred). The 0-based beginning and ending positions are written back to beg and end, respectively. The last argument param is the single parameter used in the algorithm, which is optional and defaults 0.05.</li>
<li>and(x, y) bit AND operation (&amp; in C)</li>
<li>or(x, y) bit OR operation (| in C)</li>
<li>xor(x, y) bit XOR operation (^ in C)</li>
</ul>
<p><strong>内建变量</strong></p>
<ul>
<li>bed: 1:chrom 2:start 3:end 4:name 5:score 6:strand 7:thickstart 8:thickend 9:rgb 10:blockcount 11:blocksizes 12:blockstarts</li>
<li>sam: 1:qname 2:flag 3:rname 4:pos 5:mapq 6:cigar 7:rnext 8:pnext 9:tlen 10:seq 11:qual</li>
<li>vcf: 1:chrom 2:pos 3:id 4:ref 5:alt 6:qual 7:filter 8:info</li>
<li>gff: 1:seqname 2:source 3:feature 4:start 5:end 6:score 7:filter 8:strand 9:group 10:attribute</li>
<li>fastx: 1:name 2:seq 3:qual</li>
</ul>
<h3 id="1">1. 安装<a class="headerlink" href="#1" title="Permanent link">&para;</a></h3>
<p>在 Linux 中安装 bioawk</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Ubuntu 中源码编译安装</span>
$ sudo apt-get install bison
$ git clone https://github.com/lh3/bioawk
$ <span class="nb">cd</span> bioawk <span class="o">&amp;&amp;</span> make
$ sudo cp bioawk /usr/local/sbin

<span class="c1"># Archlinux aur 安装包安装</span>
$ git clone https://aur.archlinux.org/bioawk.git
$ <span class="nb">cd</span> bioawk
$ makepkg -si

<span class="c1"># conda 安装</span>
<span class="o">(</span>base<span class="o">)</span>$ conda install bioawk
</code></pre></div>

<p>查看说明文档</p>
<div class="highlight"><pre><span></span><code>$ <span class="nb">cd</span> bioawk
$ man ./awk.1
</code></pre></div>

<h3 id="2">2. 使用示例<a class="headerlink" href="#2" title="Permanent link">&para;</a></h3>
<p>使用示例部分使用 NCBI SRA 数据库的 illumina 测序数据 SRR1175124 为例</p>
<ul>
<li>fastq: SRR1175124</li>
<li>bed:</li>
<li>vcf:</li>
</ul>
<h4 id="fastq">处理 fastq<a class="headerlink" href="#fastq" title="Permanent link">&para;</a></h4>
<p><strong>计算reads数量</strong></p>
<p>构建测序数据分析的 workflow 时，当 fastq 数据筛选后，如果要查看剩下多少 reads，可以用 bioawk 进行快速统计。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 去除低质量reads后，快速统计fastq里的reads数量</span>
$ bioawk -c fastx <span class="s1">&#39;END { print NR }&#39;</span> SRR1175124_1.fastq.gz
<span class="m">102354</span>
$ <span class="nb">echo</span> <span class="sb">`</span>zcat SRR1175124_1.fastq.gz <span class="p">|</span> wc -l<span class="sb">`</span> / <span class="m">4</span> <span class="p">|</span> bc
<span class="m">102354</span>

<span class="c1"># 统计以GATTAC开头的reads的数量</span>
$ bioawk -c fastx <span class="s1">&#39;$seq ~ /^GATTAC/ {++n} END { print n }&#39;</span> SRR1175124_1.fastq.gz
<span class="c1"># 用 grep 实现</span>
$ zcat SRR1175124_1.fastq.gz <span class="p">|</span> grep <span class="s1">&#39;^GATTAC&#39;</span> <span class="p">|</span> wc -l

<span class="c1"># 查看GC含量大于60%的reads的质量情况</span>
$ bioawk -c fastx <span class="s1">&#39;{if (gc($seq)&gt;0.6) printf &quot;%s\n%s\n\n&quot;, $seq, $qual}&#39;</span> <span class="se">\</span>
&gt; SRR1175124_1.fastq.gz

<span class="c1"># 生成reads的平均Q值</span>
$ bioawk -c fastx <span class="s1">&#39;{print $name, meanqual($seq)}&#39;</span> <span class="se">\</span>
&gt; SRR1175124_1.fastq.gz &gt; meanqual.txt

<span class="c1"># 将前5条reads序列的5&#39;-&gt;3&#39;变为3&#39;-&gt;5&#39;</span>
$ bioawk -c fastx <span class="s1">&#39;{if(NR&lt;6) print reverse($seq)}&#39;</span> SRR1175124_1.fastq.gz

<span class="c1"># 输出前5条reads序列的反义互补序列</span>
$ bioawk -c fastx <span class="s1">&#39;{if(NR&lt;6) print revcomp($seq)}&#39;</span> SRR1175124_1.fastq.gz

<span class="c1"># 输出第100条reads的信息</span>
$ bioawk -c fastx <span class="s1">&#39;NR==100{print &quot;&gt;&quot;$name, gc($seq)}&#39;</span> SRR1175124_1.fastq.gz

<span class="c1"># 统计SRR1175124_1.fastq.gz中reads碱基Q值高于35的个人小于50的reads数</span>
$ bioawk -c fastx <span class="s1">&#39;{if(qualcount($qual, 35)&lt;50) print $name,$seq}&#39;</span> <span class="se">\</span>
&gt; SRR1175124_1.fastq.gz <span class="p">|</span> wc -l

<span class="c1"># 双末端测序的碱基Q值高于35的个数小于50的reads</span>
$ bioawk -c fastx <span class="s1">&#39;{if(qualcount($qual, 35)&lt;50) print $name}&#39;</span> <span class="se">\</span>
&gt; SRR1175124_1.fastq.gz SRR1175124_2.fastq.gz <span class="p">|</span> sort <span class="p">|</span> uniq -c <span class="p">|</span> <span class="se">\</span>
&gt; awk <span class="s1">&#39;$1==2{print}&#39;</span>

<span class="c1"># 输出双末端测序的碱基Q值高于35的个数小于50的reads中以5’-ATG的reads</span>
$ <span class="k">for</span> i in <span class="k">$(</span>bioawk -c fastx <span class="s1">&#39;{if(qualcount($qual, 35)&lt;50) print $name}&#39;</span> <span class="se">\</span>
&gt; SRR1175124_1.fastq.gz  SRR1175124_2.fastq.gz <span class="p">|</span> sort <span class="p">|</span> uniq -c <span class="p">|</span> <span class="se">\</span>
&gt; awk <span class="s1">&#39;$1==2{print $2}&#39;</span><span class="k">)</span><span class="p">;</span> <span class="k">do</span> bioawk -c fastx -v <span class="nv">i</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$i</span><span class="s2">&quot;</span> <span class="se">\</span>
&gt; <span class="s1">&#39;{if($name==i &amp;&amp; $seq ~ /^ATG/) print $name&quot;\n&quot;$seq&quot;\n&quot;$qual&quot;\n&quot;}&#39;</span> <span class="se">\</span>
&gt; SRR1175124_1.fastq.gz SRR1175124_2.fastq.gz<span class="p">;</span> <span class="k">done</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>$ bioawk -c bed <span class="s1">&#39;{ print $end - $start }&#39;</span> .bed
</code></pre></div>

<h4 id="bam">处理 bam<a class="headerlink" href="#bam" title="Permanent link">&para;</a></h4>
<h4 id="vcf">处理 vcf<a class="headerlink" href="#vcf" title="Permanent link">&para;</a></h4>
<h4 id="bed">处理 bed<a class="headerlink" href="#bed" title="Permanent link">&para;</a></h4>
<h4 id="gff">处理 gff<a class="headerlink" href="#gff" title="Permanent link">&para;</a></h4>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../03_linux-software/" title="03. Linux 软件管理" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                03. Linux 软件管理
              </div>
            </div>
          </a>
        
        
          <a href="../05_sed/" title="05. sed 行处理工具" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                05. sed 行处理工具
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2018 HZCDC@Lab
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.a0c4167b.min.js"></script>
      <script src="../../assets/javascripts/bundle.fb26dd1d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.37585f48.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sequence-diagrams/1.0.6/sequence-diagram-min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script>
      
        <script src="../../assets/js/umlconvert.js"></script>
      
    
  </body>
</html>